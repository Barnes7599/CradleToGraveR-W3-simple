---
title: ggplotResiduals  Predictions  Plots R
date: 2020-05-14
categories:
  - ggplot
tags:
  - Test
  - Test2

type:  "post"
w3codecolor: false
draft: false
thumbnail: https://i.ytimg.com/vi/DK11khHTMs0/maxresdefault.jpg
---



<p><a href="https://www.youtube.com/watch?v=DK11khHTMs0">
<img src="auto-posts/images/12-ggplot-RPredictPlotModel2.mp4.jpg">
</a></p>
<p>00:00
in this tutorial I’m gonna show you how to create this cool little plot it’s
basically a linear model that is created based on the empty cars data set and it
shows us our predicted versus actual values with our residual errors which is
basically the error rate also so stay tuned and let’s get right into it so
first we’re gonna start with our favorite data set empty cars and we’ll
set that as my data which is nothing new here so equals empty cars command enter
let’s take a quick peek at that data set I’m gonna zoom in a little bit we have
our regular miles per gallon cylinders etc etc and you can see over here the
last feature is carb so close that out and what we’re gonna do is we’re gonna</p>
<p>00:01
create a fitted model and so this is our model we’re gonna call it we’ll call it
model one like always and it’s a linear model and we’re gonna try to predict
miles per gallon again explained by weight now we’ve done this before our
data is equal to my data so it’s not nothing big here we’re gonna create a
model so we created a model one now we might have multiple models the model
itself is biased because we chose hey we think there might be some relationship
between weight and miles per gallon it’s
a pure arbitrary choice that we made now it could have been a better model was
based on miles per gallon ten and a quarter second mile we don’t know
because we haven’t played with that yet right but this for example is our first
model which is biased and reducible a reducible error so if this model doesn’t
work we can create a better model we have that ability to create better and
better models now there’s irreducible errors don’t
forget where there’s certain error in in the actual data that you just cannot</p>
<p>00:02
predict but this one you can always create a better model so let’s start
with that what we’re gonna do is we’re gonna add
our predicted and residuals to this model so let’s just go ahead and do my
data and we’re gonna create a feature called predicted
predicted values basically is equal to our predict function predict and we’re
gonna predict based on our fit our model the model that we created right command
enter so again my data my data I’m creating predicted on the fly using a
little dollar sign here I’m gonna sign that equal to a predict function I’m
gonna say hey take my model one that I just created plug it into this predict
function and add those values down the hole down the column called predicted
let’s take a look at that right now and I’m gonna click on my data and you’ll
see that I have predicted on the right hand side so miles per gallon was twenty</p>
<p>00:03
one point zero I predicted twenty three point two eight so there’s a little bit
of an error there so let’s just continue down this path and create the residuals
next so my data I’m gonna call this residuals because just because it makes
sense or we can call it error whatever residuals is equal to now there’s a
residuals function are ESI dua yeah and what we’re gonna put in there is also
our model okay so let’s create that we’ve done it let’s check it out model
one get me out of the way oops not model one my data so now we
have residuals which is basically the amount of error so it wasn’t twenty
three point two eight it was twenty one what’s the difference negative two point
two eight if you scroll down all the way to say Chrysler Imperial fourteen point
seven was the predicted or was the actual miles per gallon but the
predicted is eight point seven so it’s off by five point nine it’s pretty high</p>
<p>00:04
right and the one even below is off by six point eight so that’s what that’s
shown us just the amount of difference there is between the actual and the
predicted values so let’s go back to the screen here and now let’s create that
cool graph step by step I’ll show you what it’s doing to a point I think
you’ll get the hint as we build it so first we’ll do well we’re gonna load
our library ggplot2 load that up and let’s just create a
plot and our aesthetic we’re gonna have our X Act was access equal to the weight
and the y axis equal to the miles per gallon as always and then from they are
gonna add let’s add our linear model so our GM smooth that’s the function we use
and we say method equals linear model LM
and from there we can actually plot that excuse me
error data must be a data frame oh I didn’t add the data let’s start with</p>
<p>00:05
that so data equals my data comma and then we should be good to go all right
let me zoom back out so you can see it so I had a couple of errors because I
didn’t add the data so there’s our model that’s cool we’re gonna get rid of the
gray confidence interval because we’re not going to use that so we’re just
gonna say se is equal to false and that should rerun it without the gray now
it’s not a cool looking graph but we’re gonna get there so be patient so we’re
gonna add line segments to this so we want to find the line segment that goes
from the predicted value to the actual value so what we’re gonna do is we’re
going to add another geometry called genome segment and our aesthetic on this
one is going to be we have X and is equal to the weight and Y and is equal
to the predicted value predicted and we’re gonna be doing alpha value which
is basically the transparent value of 0.3 whatever you want to put you can
play around that command enter and you’ll see we should have error there’s</p>
<p>00:06
an error but you know these things happen alpha equals oh my goodness got
it okay now that I figured out that I missed an equal sign it took me about
three or four minutes to figure out we now have let’s zoom in on this a little
bit okay you could see the line segments were created so this is the actual
linear model so if the weight was you know two points something here we go up
and say hey here’s what the prediction is but the actual is way up here right
so that’s what we’re creating let me close that out and we’re gonna add more
to this so now that we have our line segments let’s add some points to the
so Geum win a Gian point and in this we’re gonna have an aesthetic and want
to call this aesthetic that color equals when do absolute value of the residuals
and will make the size equal to the absolute value of the residuals as well</p>
<p>00:07
just to make it pretty clear on what’s what ok there we go we run that zoom in
so remember it knows what data were looking at because we said data equals
my data and my data has residuals in there don’t forget we added that using
that dollar sign so that’s why we’re allowed to just use the word residuals
it’s fine so this is pretty cool we now have a linear model and we have the
errors and you can see that the error is basically you know the further away it
is from the actual the bigger the ball is right and we can actually even color
code this and do other stuff that there’s a lot of us that you won’t
memorize but you can just kind of reuse so we can do a scale color continuous
this is probably something you’ll use a lot and we’ll set a low is equal to a
green and a high is equal to red which is pretty common and it just gives us a
better visual as we build this we can just continue on this path so now even
though the size is there the fact that it’s red and green means you know though</p>
<p>00:08
the redder it is the more of an error there is the greener it is to less it’s
just one more thing to add to your list of visuals we can get rid of the guides
the legends so we’re gonna say guides we don’t want any colors and we don’t want
any size equals false we don’t we just want to clean it up a little bit so just
to create this cool plot boom there it is so the further away it is the redder
the bigger and there we have it boom that tells us quite a lot in that one
little thing we can also create a theme that will help us clean it up a little
bit without doing a whole lot of extra work so theme it goes BW and I think it
just basically cleans up the axes and the displays and the fonts things
like that so there we have it that’s what we have that’s what we showed so we</p>
<p>00:09
have a linear model and now we can see how well our linear model fit the data
in a very good way so you can definitely show this and portray it and say you
know this is what we have we have a couple of things out here that might be
a little bit off but let’s let’s continue on with this tutorial and we’re
going to talk about just a simple simple
plot I’m not gonna explain too much more into it but when do a plot and we’re
just gonna basically plot our fitted line so our model 1 which is the
prediction or the model that we created I’m gonna plot that you’ll see down at
the bottom I have hit return to get the plot hit return you’ll see a plot show
up I’m gonna hit return a couple times to get all the plots there’s another
plot another plot another plot so there we have it I’m gonna zoom well I’m not
gonna zoom in actually till we get to the first plot I can explain this real
quick now so you can kind of get a quick
idea of what’s going on ok so this first one when you plot the model what this</p>
<p>00:10
shows us is residuals versus fitted right what you want to see here is you
don’t want to see a distinct like sine wave or something weird you know it kind
of wants to be linear it’s not curved that much that’s not that’s not a deal
breaker yet we’re trying to figure out is this a linear model should we even be
using a linear model to fit this data right to predict and the answer is
according to this graph probably still a good fit with a linear model because
it’s not too curved just not like wildly crazy curved it’s you know sort of
straight we’ve got about half of the data points above the red line and half
below and that’s what you want to look for now if all the data points were
below or all the data points were above you’d have issues then you’d say you’d
have to say you know what that reducible
error called the the model selection can be fixed because this model certainly
doesn’t seem right but this one according to the data you can see the
the number of dots on the below and well
and above the red line or about equal so that’s what we’re looking for there
let’s move on to the next one and again over time you’ll get into what all this</p>
<p>00:11
stuff means and this isn’t really a statistics tutorial but you kind of have
to know some statistics to understand what’s going on to pick the right models
now this one here is the normal QQ plot and so I hit that right arrow on the
plots to get to the next plot and what you want to see is most of these dots
you want to see the mostly line up with this line and when they do you know that
it’s a normal distributed data set and all of our predictions all of our
statistics is based on the fact that we think that this is a normally
distributed data set okay so let me zoom
in on that you can see they’re all lined up pretty good and if it’s not normally
distributed again some of our assumptions have to be thrown out the
window we’re assuming all these things are correct based on it’s normally
distributed and this will prove it hey that’s pretty close to normally
distribute it that’s what it shows all right the next one let’s see this is the
scale location again at this one you just want to make sure that you want you</p>
<p>00:12
have the same amount of dots above and below the line I believe this is
basically a variability plot it means that if you have errors in your data its
equal on the top and the bottom you know they average out to be 0 okay and
finally these are just certain things that you’ll be looking at over and over
again as you progress all right and this one here is a residual versus leverage
all this one is saying is are there any outliers that are causing a lot of the
reason why the graph is the way it is so maybe there’s like one outlier that was
just super far out right and it’s causing your graph to skew completely
and you like or maybe not excused the right the correct term but the models
gonna be completely different based on that one data point does one data point
have any influence over all the other ones does it have leverage over all the
other points and this is what shows you that now I’m not gonna get into what all
these things are like cooks distance and all that but what you want to look for
is that cooks distance right here see that little red line right here if</p>
<p>00:13
there’s data points below that red line then like let’s say this one’s pretty
close right here right this little data point right by cooks distance if that
was below the line you would you’d want to ask yourself the question is that a
valid data point was there an arid was there a human error what is that data
point you know go research why that is the way it is it must be very off now
that doesn’t mean you throw it out for the model it does
not mean that it just means you have to go question why that data points there
if it’s in fact a false data point you can get rid of it sure but it might be
real so that’s why you have to research before you make any decisions on getting
rid of data so that’s all that is so that’s the Kochs distance if anything is
below that go question what that data is find out and see if it really is valid
and that’s it I know this is kind of a lot and you don’t have to understand the
mathematics behind all this yet but knowing how to read these charts to see
if your assumptions your models are correct remember we just created one
model that’s why I’ve been calling it model one we’re gonna have model one
model to model three we’re gonna compare</p>
<p>00:14
models see which one’s the best the best
for predictions we’re gonna be doing all that in the future so I hope that this
helped you understand you know some more of why we’re doing what we’re doing see
in the next episode if you like this video go ahead and hit the like button
or subscribe please share with your friends and throw it on social media if
you can put this on Twitter maybe tag a few things like statistics
or stats or our data science things like that that help me out greatly I
appreciate it and I will see you guys in the next lesson you [Music]End of file</p>
